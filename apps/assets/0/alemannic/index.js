"use strict";(()=>{var p="https://raw.githubusercontent.com/axtk/axtk.github.io/refs/heads/main/apps/";async function P(){return(await(await fetch(`${p}assets/alemannic/samples.json`)).json()).alemannic}async function L(){let t=["ch","li","at","it","fr","de"],[o,e,r,a,n,l]=await Promise.all(t.map(async m=>(await fetch(`${p}assets/alemannic/places/${m}.json`)).json()));return[...o.slice(0,18),...e.slice(0,2),...r.slice(0,12),...a.slice(0,55),...n.slice(0,55),...l.slice(0,55)]}var s=[[36.5,15.9,"Basel-Stadt"],[76.2,32.3,"Eschen, Liechtenstein"]],c=null,g=null,M=null;function u({markers:t},o,e){c===null&&(c=[t.find(({title:n})=>n.includes(s[0][2])).position,t.find(({title:n})=>n.includes(s[1][2])).position]),g===null&&(g=(s[1][0]-s[0][0])/(c[1][1]-c[0][1])),M===null&&(M=(s[1][1]-s[0][1])/(c[1][0]-c[0][0]));let r=s[0][0]+g*(e-c[0][1]),a=s[0][1]+M*(o-c[0][0]);return{x:r,y:a}}function f(){for(let t of document.querySelectorAll("#map .marker"))t.classList.remove("selected")}function x(t){return t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"):""}function E(t,o){let e=document.createDocumentFragment();for(let r of o){let a=Number(r.dataset.index),n=t.markers[a];if(n){if(n.title){let l=document.createElement("div");l.className="item-title",l.textContent=n.title,e.appendChild(l)}for(let{title:l,author:m,url:i,source:C}of n.resources){let d=document.createElement("figure");d.innerHTML=`<figcaption class="title"><span class="title-content">${x(l)}</span> <span class="author">${x(m)}</span></figcaption><audio controls src="${i}"></audio><figcaption class="source">Source: ${x(C)}</figcaption>`,e.appendChild(d)}}}return e}function y(){for(let t of document.querySelectorAll("#playlist audio"))t.pause(),t.currentTime=0}function k(){y(),f(),document.querySelector("#playlist")?.classList.add("hidden")}function h(t,o){let e=document.querySelector("#playlist");if(!e)return;if(!o||!o.length){window.sendEvent?.("close_playlist.click_screen"),k();return}let r=document.createElement("div");if(r.className="list",r.appendChild(E(t,o)),!r.innerHTML)return;let a=document.createElement("button");a.className="close",a.textContent="\u2715\xA0 Close",a.addEventListener("click",()=>{k(),window.sendEvent?.("close_playlist.click_button")}),e.innerHTML="",e.appendChild(r),e.appendChild(a),e.classList.remove("hidden");for(let n of o)n.classList.add("selected");for(let n of e.querySelectorAll("audio"))n.addEventListener("play",()=>{window.sendEvent?.(["play",String(n.src.split("/").pop())])})}var b=0,w=0,S=!1;function v(t){if(S)return;let o=document.querySelector("#map");o.addEventListener("click",({clientX:e,clientY:r})=>{y(),f();let n=Array.from(o.querySelectorAll(".marker")).filter(l=>{let{left:m,right:i,top:C,bottom:d}=l.getBoundingClientRect();return e>m-b&&e<i+b&&r>C-w&&r<d+w});for(let l of n)window.sendEvent?.(["click_marker",String(l.getAttribute("title"))]);h(t,n)}),document.addEventListener("click",e=>{(!(e.target instanceof HTMLElement)||!e.target.closest("#map, button.close"))&&h(t,null)}),S=!0}function q(t){let o=document.querySelector("#map"),e=document.createDocumentFragment();for(let r=0;r<t.markers.length;r++){let{position:a,title:n}=t.markers[r],{x:l,y:m}=u(t,a[0],a[1]),i=document.createElement("button");i.className="marker",i.style.left=`${l}%`,i.style.top=`${m}%`,i.title=n,i.dataset.index=String(r),e.appendChild(i)}o.appendChild(e),v(t)}var H={Geneva:"Gen\xE8ve",Lucerne:"Luzern",Vienna:"Wien"};function R({places:t}){let o=document.querySelector("#map"),e=document.createDocumentFragment();for(let{city:r,x:a,y:n}of t){let l=document.createElement("div");l.className="place",l.textContent=H[r]||r,l.style.left=`${a}%`,l.style.top=`${n}%`,e.appendChild(l)}o.appendChild(e)}var $=["Uster","Vernier","Schaan"];function T(t,o){return o.map(e=>({...e,...u(t,Number(e.lat),Number(e.lng))})).filter(({city:e,x:r,y:a})=>!(r<0||r>100||a<0||a>100)&&!$.includes(e))}function A(){Promise.all([P(),L()]).then(([t,o])=>{let e={markers:t,places:T({markers:t},o)};R(e),q(e)})}A();})();
